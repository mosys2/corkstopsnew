@using Store.Application.Services.Products.Queries.GetProductDetail
@using Store.Common.Constant
@addTagHelper *,LazZiya.TagHelpers
@addTagHelper *,Microsoft.AspNetCore.Mvc.TagHelpers
@model RequestEditProductDto
@{
    ViewData["Title"] = "Edit";
    Layout = "~/Areas/Admin/Views/Shared/_Adminlayout.cshtml";
    string ftpUrl = PublicConst.FtpUrl;
}

<!-- BEGIN: Content -->
<div class="content">
    <div class="intro-y flex items-center mt-8">
        <h2 class="text-lg font-medium mr-auto">
            Edit Product
        </h2>
    </div>
    <div class="grid grid-cols-11 gap-x-6 mt-5 pb-20">
        <div class="intro-y col-span-11 2xl:col-span-9">
            <form id="frm-product">
                <input type="hidden" asp-for="Id" />
                <!-- BEGIN: Uplaod Product -->
                <div class="intro-y box p-5">
                    <div class="border border-slate-200/60 dark:border-darkmode-400 rounded-md p-5">
                        <div class="font-medium text-base flex items-center border-b border-slate-200/60 dark:border-darkmode-400 pb-5"> <i data-lucide="chevron-down" class="w-4 h-4 mr-2"></i> Upload Product </div>
                        <div class="mt-5">
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Thumbnail</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 d-flex d-inline-flex">
                                    <input asp-for="MinPic" value="@Model.MinPic" type="text" class="form-control" placeholder="Thumbnail url">
                                    <button type="button" id="btn-select-thumbnail" data-selector-id="MinPic" class="btn btn-primary ml-1 w-44 select-image"> <i data-lucide="plus" class="w-4 h-4 mr-2"></i> Select </button>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Image</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 d-flex d-inline-flex">
                                    <input asp-for="Pic" type="text" class="form-control" placeholder="Image url">
                                    <button type="button" data-selector-id="Pic" class="btn btn-primary ml-1 w-44 select-image"> <i data-lucide="plus" class="w-4 h-4 mr-2"></i> Select </button>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-10">
                                <div class="form-label w-full xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Product Photos</div>
                                        </div>
                                        <div class="leading-relaxed text-slate-500 text-xs mt-3">
                                            <div>The image format is .jpg .jpeg .png and select from file manager.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1 border-2 border-dashed dark:border-darkmode-400 rounded-md pt-4">
                                    <div class="grid grid-cols-10 gap-5 pl-4 pr-5" id="box-selected-images">
                                        @foreach(var item in Model.Media)
                                        {
                                            <div class="col-span-5 md:col-span-2 h-28 relative image-fit cursor-pointer zoom-in">
                                                <img class="rounded-md" alt="@item" src="@ftpUrl@item">
                                                <div title="Remove this image?" data-path="@item" id="remove-from-list" class="item-slected-file tooltip w-5 h-5 flex items-center justify-center absolute rounded-full text-white bg-danger right-0 top-0 -mr-2 -mt-2">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" icon-name="x" data-lucide="x" class="lucide lucide-x w-4 h-4"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                    <div class="px-4 pb-4 mt-5 flex items-center justify-center cursor-pointer relative">
                                        <i data-lucide="image" class="w-4 h-4 mr-2"></i> <span class="text-primary mr-1">Select product photos</span>
                                        <div id="horizontal-form-1" class="w-full h-full top-0 left-0 absolute opacity-0 select-images"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END: Uplaod Product -->
                <!-- BEGIN: Product Information -->
                <div class="intro-y box p-5 mt-5">
                    <div class="border border-slate-200/60 dark:border-darkmode-400 rounded-md p-5">
                        <div class="font-medium text-base flex items-center border-b border-slate-200/60 dark:border-darkmode-400 pb-5"> <i data-lucide="chevron-down" class="w-4 h-4 mr-2"></i> Product Information </div>
                        <div class="mt-5">
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Product Name</div>
                                            <div class="ml-2 px-2 py-0.5 bg-slate-200 text-slate-600 dark:bg-darkmode-300 dark:text-slate-400 text-xs rounded-md">Required</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <input asp-for="Name" type="text" class="form-control" placeholder="Product name">
                                    <span asp-validation-for="Name" class="pristine-error text-danger mt-2"></span>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Slug</div>
                                            <div class="ml-2 px-2 py-0.5 bg-slate-200 text-slate-600 dark:bg-darkmode-300 dark:text-slate-400 text-xs rounded-md">Required</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <input asp-for="Slug" type="text" class="form-control" placeholder="Slug">
                                    <span asp-validation-for="Slug" class="pristine-error text-danger mt-2"></span>
                                    <div class="form-help text-right"></div>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Brand</div>
                                            <div class="ml-2 px-2 py-0.5 bg-slate-200 text-slate-600 dark:bg-darkmode-300 dark:text-slate-400 text-xs rounded-md">Required</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <select asp-for="BrandId" asp-items="ViewBag.Brands" class="form-select">
                                    </select>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Category</div>
                                            <div class="ml-2 px-2 py-0.5 bg-slate-200 text-slate-600 dark:bg-darkmode-300 dark:text-slate-400 text-xs rounded-md">Required</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <select asp-for="CategoryId" asp-items="ViewBag.Categories" class="form-select">
                                    </select>

                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Tags</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1 d-flex d-inline-flex">
                                    <select asp-for="TagsId" asp-items="ViewBag.Tags" data-placeholder="Etalase" class="tom-select w-full" multiple>
                                    </select>
                                    <button type="button" id="btn-add-tags" class="btn btn-primary ml-1 w-44"> <i data-lucide="plus" class="w-4 h-4 mr-2"></i> Add </button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <!-- END: Product Information -->
                <!-- BEGIN: Product Detail -->
                <div class="intro-y box p-5 mt-5">
                    <div class="border border-slate-200/60 dark:border-darkmode-400 rounded-md p-5">
                        <div class="font-medium text-base flex items-center border-b border-slate-200/60 dark:border-darkmode-400 pb-5"> <i data-lucide="chevron-down" class="w-4 h-4 mr-2"></i> Product Detail </div>
                        <div class="mt-5">
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Product Description</div>
                                            <div class="ml-2 px-2 py-0.5 bg-slate-200 text-slate-600 dark:bg-darkmode-300 dark:text-slate-400 text-xs rounded-md">Required</div>
                                        </div>
                                        <div class="leading-relaxed text-slate-500 text-xs mt-3">
                                            <div>Make sure the product description provides a detailed explanation of your product so that it is easy to understand and find your product.</div>
                                            <div class="mt-2">It is recommended not to enter info on mobile numbers, e-mails, etc. into the product description to protect your personal data.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <textarea class="editor">
                                        @Html.Raw(Model.Content)
                                    </textarea>
                                    <div class="form-help text-right">Maximum character 0/2000</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END: Product Detail -->
                <!-- BEGIN: Product Variant (Details) -->
                <div class="intro-y box p-5 mt-5">
                    <div class="border border-slate-200/60 dark:border-darkmode-400 rounded-md p-5">
                        <div class="font-medium text-base flex items-center border-b border-slate-200/60 dark:border-darkmode-400 pb-5"> <i data-lucide="chevron-down" class="w-4 h-4 mr-2"></i> Product feature </div>
                        <div class="mt-5">
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Feature Information</div>
                                        </div>
                                        <div class="leading-relaxed text-slate-500 text-xs mt-3">Add feature to product detail in website</div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <div class="sm:grid grid-cols-3 gap-2">
                                        <input id="Title-Feature" type="text" class="form-control mt-2 sm:mt-0" placeholder="Title">
                                        <input id="Value-Feature" type="text" class="form-control mt-2 sm:mt-0" placeholder="Value">
                                        <button type="button" id="Add-Feature-To-List" class="btn btn-primary mt-2 sm:mt-0"> Add To List </button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Feature List</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <div class="overflow-x-auto">
                                        <table class="table border Table-Feature">
                                            <thead>
                                                <tr>
                                                    <th class="bg-slate-50 dark:bg-darkmode-800 text-slate-500 whitespace-nowrap w-45percent">Title</th>
                                                    <th class="bg-slate-50 dark:bg-darkmode-800 text-slate-500 whitespace-nowrap w-45percent">Value</th>
                                                    <th class="bg-slate-50 dark:bg-darkmode-800 text-slate-500 whitespace-nowrap w-10percent"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach(var item in Model.FeatureList)
                                                {
                                                    <tr><td>@item.Title</td><td>@item.Value</td><td><button id="delete-feature" class="btn btn-danger mr-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash w-4 h-4"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button></td></tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END: Product Variant (Details) -->
                <!-- BEGIN: Product Management -->
                <div class="intro-y box p-5 mt-5">
                    <div class="border border-slate-200/60 dark:border-darkmode-400 rounded-md p-5">
                        <div class="font-medium text-base flex items-center border-b border-slate-200/60 dark:border-darkmode-400 pb-5"> <i data-lucide="chevron-down" class="w-4 h-4 mr-2"></i> Product Management </div>
                        <div class="mt-5">
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Product Status</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <div class="form-check form-switch">
                                        <input asp-for="IsActive" class="form-check-input" type="checkbox">
                                        <label class="form-check-label" for="product-status-active">Active</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Price</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <div class="sm:grid grid-cols-1 gap-2">
                                        <div class="input-group">
                                            <div class="input-group-text">$</div>
                                            <input asp-for="Price" type="number" class="form-control" placeholder="Price">
                                        </div>
                                        <span asp-validation-for="Price" class="pristine-error text-danger mt-2"></span>

                                    </div>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Quantity</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <div class="sm:grid grid-cols-1 gap-2">
                                        <div class="input-group">
                                            <div class="input-group-text">Count</div>
                                            <input asp-for="Quantity" type="number" class="form-control" placeholder="Count">
                                        </div>
                                        <span asp-validation-for="Quantity" class="pristine-error text-danger mt-2"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Postage fee</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <div class="sm:grid grid-cols-1 gap-2">
                                        <div class="input-group">
                                            <div class="input-group-text">$</div>
                                            <input asp-for="PostageFee" type="number" class="form-control" placeholder="Fee">
                                        </div>
                                        <span asp-validation-for="PostageFee" class="pristine-error text-danger mt-2"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-inline items-start flex-col xl:flex-row mt-5 pt-5 first:mt-0 first:pt-0">
                                <div class="form-label xl:w-64 xl:!mr-10">
                                    <div class="text-left">
                                        <div class="flex items-center">
                                            <div class="font-medium">Postage fee based quantity</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full mt-3 xl:mt-0 flex-1">
                                    <div class="sm:grid grid-cols-1 gap-2">
                                        <div class="input-group">
                                            <div class="input-group-text">$</div>
                                            <input asp-for="PostageFeeBasedQuantity" type="number" class="form-control" placeholder="Fee">
                                        </div>
                                        <span asp-validation-for="PostageFeeBasedQuantity" class="pristine-error text-danger mt-2"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END: Product Management -->
                <div class="flex justify-end flex-col md:flex-row gap-2 mt-5">
                    <button type="reset" class="btn py-3 border-slate-300 dark:border-darkmode-400 text-slate-500 w-full md:w-52">Cancel</button>
                    <button id="register-product" type="submit" class="btn py-3 btn-primary w-full md:w-52">Save & Edit Product</button>
                </div>
            </form>

        </div>

        <div class="intro-y col-span-2 hidden 2xl:block">
            <div class="pt-10 sticky top-0">
                <ul class="text-slate-500 relative before:content-[''] before:w-[2px] before:bg-slate-200 before:dark:bg-darkmode-600 before:h-full before:absolute before:left-0 before:z-[-1]">
                    <li class="mb-4 border-l-2 pl-5 border-primary dark:border-primary text-primary font-medium"> <a href="">Upload Product</a> </li>
                    <li class="mb-4 border-l-2 pl-5 border-transparent dark:border-transparent"> <a href="">Product Information</a> </li>
                    <li class="mb-4 border-l-2 pl-5 border-transparent dark:border-transparent"> <a href="">Product Detail</a> </li>
                    <li class="mb-4 border-l-2 pl-5 border-transparent dark:border-transparent"> <a href="">Product Variant</a> </li>
                    <li class="mb-4 border-l-2 pl-5 border-transparent dark:border-transparent"> <a href="">Product Variant (Details)</a> </li>
                    <li class="mb-4 border-l-2 pl-5 border-transparent dark:border-transparent"> <a href="">Product Management</a> </li>
                    <li class="mb-4 border-l-2 pl-5 border-transparent dark:border-transparent"> <a href="">Weight & Shipping</a> </li>
                </ul>
                <div class="mt-10 bg-warning/20 dark:bg-darkmode-600 border border-warning dark:border-0 rounded-md relative p-5">
                    <i data-lucide="lightbulb" class="w-12 h-12 text-warning/80 absolute top-0 right-0 mt-5 mr-3"></i>
                    <h2 class="text-lg font-medium">
                        Tips
                    </h2>
                    <div class="mt-5 font-medium">Price</div>
                    <div class="leading-relaxed text-xs mt-2 text-slate-600 dark:text-slate-500">
                        <div>The image format is .jpg .jpeg .png and a minimum size of 300 x 300 pixels (For optimal images use a minimum size of 700 x 700 pixels).</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END: Content -->
<!-- BEGIN: Modal Content -->
<div id="modalSelectFiles" class="modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!-- BEGIN: Modal Header -->
            <div class="modal-header">
                <h2 class="font-medium text-base mr-auto">
                    File Manager
                </h2>
                <button id="back-button" onclick="backToLastDirectory()" class="btn btn-primary w-32 mr-2 d-none">
                    <i data-lucide="corner-up-left" class="w-4 h-4 mr-2"></i> Back
                </button>
                <button onclick="goToRoot()" class="btn btn-secondary w-24 inline-block mr-1 ">Root</button>
                <div class="dropdown sm:hidden">
                    <a class="dropdown-toggle w-5 h-5 block" href="javascript:;" aria-expanded="false" data-tw-toggle="dropdown"> <i data-lucide="more-horizontal" class="w-5 h-5 text-slate-500"></i> </a>
                    <div class="dropdown-menu w-40">
                        <ul class="dropdown-content">
                            <li>
                                <a href="javascript:;" class="dropdown-item"> <i data-lucide="file" class="w-4 h-4 mr-2"></i> Download Docs </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- END: Modal Header -->
            <!-- BEGIN: Modal Body -->
            <div id="filemanager-body" class="modal-body grid grid-cols-12 gap-4 gap-y-3">
            </div>
            <!-- END: Modal Body -->
            <!-- BEGIN: Modal Footer -->
            <div class="modal-footer" id="upload-modal-footer">
            </div>
            <!-- END: Modal Footer -->
        </div>
    </div>
</div>
<!-- END: Modal Content -->
<!-- BEGIN: Modal Content -->
<div id="modalAddTag" class="modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- BEGIN: Modal Header -->
            <div class="modal-header">
                <h2 class="font-medium text-base mr-auto">
                    Tags
                </h2>
            </div>
            <!-- END: Modal Header -->
            <!-- BEGIN: Modal Body -->
            <div id="modal-tag-body" class="modal-body">
                <div class="w-full mt-3 xl:mt-0 d-flex d-inline-flex">
                    <input id="input-tag" type="text" class="form-control" placeholder="Name">
                    <button id="btn-create-tags" class="btn btn-primary ml-1 w-44"> <i data-lucide="plus" class="w-4 h-4 mr-2"></i> Add </button>
                </div>
                <span class="error create-tag-error text-danger"></span>
            </div>
            <!-- END: Modal Body -->
        </div>
    </div>
</div>
<!-- END: Modal Content -->
@section Scripts{
        <script src="~/AdminTemplate/lib/jquery/jquery.min.js"></script>
        <script src="~/AdminTemplate/lib/jquery-validate/jquery.validate.min.js"></script>
        <script src="~/AdminTemplate/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
        <script src="~/AdminTemplate/js/ckeditor-classic.js"></script>
        <script src="~/AdminTemplate/lib/toastify-js/toastify.min.js"></script>
        <script src="~/AdminTemplate/lib/sweetalert2/sweetalert2.min.js"></script>
        <script src="~/AdminTemplate/js/main.js"></script>
        <script src="~/AdminTemplate/js/select-files.js"></script>
        <script>
            const modalAddTag = tailwind.Modal.getInstance(document.querySelector("#modalAddTag"));
            $("#btn-add-tags").on('click', function () {
                modalAddTag.show();
            });

        $(document).ready(function (e) {
            $(".item-slected-file").each(function (index, value) {
                selectedFiles.push($(this).attr('data-path'));
            });
            console.log(selectedFiles);
        });

            //Create Tag
            $("#btn-create-tags").on("click", function () {
                var TagName = $("#input-tag").val();
                if (TagName == "" || TagName == null) {
                    $(".create-tag-error").text("Please enter name.");
                    return;
                }
                var model = {
                    TagName
                }
                console.log(model);
                ajaxFunc("CreateTag", model, "POST",
                    function (result) {
                        if (result.isSuccess) {
                            modalAddTag.hide();
                            successToastify.showToast();
                            GetAllTags();
                        } else {
                            dangerToastify.showToast();
                            console.log(result.message);
                        }
                    },
                    function (error) {
                        dangerToastify.showToast();
                        console.log(error);
                    }
                );
            });

            //Get Tags
            function GetAllTags() {
                ajaxFunc("GetAllTags", null, "Get",
                    function (result) {
                        if (result.isSuccess) {
                            console.log(result);
                            let html = "";
                            result.data.map((item, index) => {
                                html += `<option value="${item.id}">${item.name}</option>`;
                            });
                            $("#TagsId").html(html);

                        } else {
                            dangerToastify.showToast();
                            console.log(result.message);
                        }
                    },
                    function (error) {
                        dangerToastify.showToast();
                        console.log(error);
                    }
                );
            }

            //Add Feature To list
            $("#Add-Feature-To-List").click(function () {
                var Title = $("#Title-Feature").val();
                var Value = $("#Value-Feature").val();
                if (Title.length == 0) {
                    $("#Title-Feature").focus().css("border", "1px solid red");
                }
                if (Value.length == 0) {
                    $("#Value-Feature").focus().css("border", "1px solid red");
                }
                else {
                    $("#Title-Feature").css("border", "");
                    $("#Value-Feature").css("border", "");
                    var newRow = $("<tr>");
                    var titleCell = $("<td>").text(Title);
                    var valueCell = $("<td>").text(Value);
                    var deleteCell = $("<td>").html('<button id="delete-feature" class="btn btn-danger mr-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash w-4 h-4"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button>');
                    newRow.append(titleCell, valueCell, deleteCell);
                    $(".Table-Feature tbody").append(newRow);

                    // پاک کردن مقادیر تکس باکس‌ها
                    $("#Title-Feature").val("");
                    $("#Value-Feature").val("");
                }
            });

            //Delete Feature From Table
            $(document).on("click", "#delete-feature", function () {
                var row = $(this).closest("tr");
                row.remove();
            });

            //Register Product
            $("#frm-product").on("submit", function (e) {
                event.preventDefault();
                if ($(this).valid()) {
                    //Add Feature
                    var featureListItem = [];
                    $('.Table-Feature tbody tr').each(function (index, value) {
                        let child = $(value).children();
                        var title = $(child[0]).text();
                        var value = $(child[1]).text();
                        featureListItem.push({ Title: `${title}`, Value: `${value}` });
                    });
                    console.log(featureListItem);

                    let tagsIdlist = [];
                    let media = [];

                    $('#TagsId :selected').each(function (i, sel) {
                        tagsIdlist.push($(sel).val());
                    });
                    let id = $('#Id').val()
                    let name = $('#Name').val()
                    let price = $('#Price').val()
                    let quantity = $('#Quantity').val()
                    let postageFee = $('#PostageFee').val();
                    let postageFeeBasedQuantity = $('#PostageFeeBasedQuantity').val();
                    let slug = $('#Slug').val();
                    let isActive = $('#IsActive').is(':checked') ? true : false
                    let minPic = $('#MinPic').val();
                    let pic = $('#Pic').val();
                    var content = $('.editor').html();
                    let categoryId = $('#CategoryId').val();
                    let brandId = $('#BrandId').val()
                    let tagsId = tagsIdlist;
                    let featureList = featureListItem;
                    media = selectedFiles;
                    var model = {
                        id, name, price, quantity, postageFee, postageFeeBasedQuantity,
                        slug, isActive, minPic, pic, content, categoryId, brandId, tagsId, featureList, media
                    }
                    console.log(model);
                    ajaxFunc("Edit", model, "POST",
                        function (result) {
                            if (result.isSuccess) {
                                successToastify.showToast();
                                setTimeout(function () {
                                    location.href = "/Admin/Product";
                                }, 2000);
                            } else {
                                dangerToastify.showToast();
                            }
                        },
                        function (error) {
                            dangerToastify.showToast();
                            console.log(error);
                        }
                    )
                }
            });

        </script>
}